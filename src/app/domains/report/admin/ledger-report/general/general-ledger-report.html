<!-- <nz-breadcrumb [nzAutoGenerate]="true"></nz-breadcrumb> -->
<div class="table-container">
    <div class="site-page-header-ghost-wrapper">
        <nz-page-header nzTitle="General Ledger List" [nzGhost]="false">
            <nz-page-header-extra>

                <!-- <lib-table-operations [showSelector1]="true" [selector1Label]="'Fiscal Year'"
                    [selector1Options]="fiscalYearListSignal()" [selector1Key]="'fiscalId'" showSelector2]="true"
                    [selector2Label]="'Account Type'" [selector2Options]="accTreeListSignal()" [selector2Key]="'id'"
                    [showAddButton]="false" [isLocalSearch]="false" [showSearch]="false" [showFromDate]="true"
                    [showToDate]="true" [defaultFromDate]="initialFilters().fromDate"
                    [defaultToDate]="initialFilters().toDate" [tertiaryButtonLabel]="'Sales Return'"
                    (search)="onSearch($event)" /> -->


            </nz-page-header-extra>

        </nz-page-header>
        <form nz-form nzLayout="vertical" [formGroup]="filterForm" class="filter-container">
            <div class="filter-grid">

                <nz-form-item class="fiscal-field">
                    <nz-form-label>Fiscal</nz-form-label>
                    <nz-form-control>
                        <nz-select nzAllowClear formControlName="fiscalId" nzPlaceHolder="Year">
                            @for (option of fiscalYearListSignal(); track option.fiscalId) {
                            <nz-option [nzValue]="option.fiscalId" [nzLabel]="option.shortName"></nz-option>
                            }
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>

                <nz-form-item class="account-field">
                    <nz-form-label>Account</nz-form-label>
                    <nz-form-control>
                        <nz-select nzAllowClear formControlName="accountId" nzShowSearch nzPlaceHolder="Select Account">
                            @for (option of accTreeListSignal(); track option.id) {
                            <nz-option [nzValue]="option.id" [nzLabel]="formatAccountLabel(option)"></nz-option>
                            }
                        </nz-select>
                    </nz-form-control>
                </nz-form-item>

                <nz-form-item class="date-field">
                    <nz-form-label>From Date</nz-form-label>
                    <nz-form-control>
                        <input nz-input formControlName="fromDate" appBsDateInput placeholder="YYYY/MM/DD" />
                    </nz-form-control>
                </nz-form-item>

                <nz-form-item class="date-field">
                    <nz-form-label>To Date</nz-form-label>
                    <nz-form-control>
                        <input nz-input formControlName="toDate" appBsDateInput placeholder="YYYY/MM/DD" />
                    </nz-form-control>
                </nz-form-item>

                <div class="search-action">
                    <button nz-button nzType="primary" (click)="applyFilters()" [disabled]="!filterForm.valid">
                        Search <span nz-icon nzType="search"> </span>
                    </button>
                </div>

            </div>
        </form>

        <div class="report-container">
            <!-- @if(data$ | async; as data) { -->
            @if(data$() ; as data) {
            <nz-table #reportTable [nzData]="data" [nzFrontPagination]="false" [nzScroll]="{ x: '800px' }">
                <thead>
                    <tr>
                        <th nzLeft>Sn.</th>
                        <th nzLeft>Date</th>
                        <th>Account</th>
                        <th nzRight>Debit</th>
                        <th nzRight>Credit</th>
                        <th nzRight>Balance</th>
                    </tr>
                </thead>
                <tbody>
                    @for (item of data; track item.voucherId; let i = $index) {
                    <tr class="data-row">
                        <td nzLeft nzAlign="center" class="index-cell">
                            {{ (reportTable.nzPageIndex - 1) * reportTable.nzPageSize + (i + 1) }}
                        </td>
                        <td nzLeft class="date-cell">{{ item.saveDate | nepaliDateFormatter }}</td>

                        <td>
                            <div class="account-cell">
                                <strong>{{ item.account }}</strong>
                            </div>
                        </td>
                        <td nzRight class="text-red">{{ item.drAmt | number:'1.2-2' }}</td>
                        <td nzRight class="text-green">{{ item.crAmt | number:'1.2-2' }}</td>
                        <td nzRight>
                            <nz-tag [nzColor]="item.balanceType === 'Dr' ? 'red' : 'green'">
                                {{ item.absBalance | number:'1.2-2' }} {{ item.balanceType }}
                            </nz-tag>
                        </td>
                    </tr>
                    }
                </tbody>
                <!-- <tfoot class="table-summary">
                <tr>
                    <td [nzLeft]="true" [colspan]="3" class="summary-label">Totals</td>
                    <td colspan="5"></td>
                    <td nzAlign="right" class="footer-total">{{ calculateSubTotal(data) | number:'1.2-2' }}</td>
                    <td nzAlign="right" class="footer-total">{{ calculateTaxTotal(data) | number:'1.2-2' }}</td>
                    <td nzAlign="right" class="footer-grand-total">{{ calculateNetTotal(data) | number:'1.2-2' }}</td>
                    <td></td>
                </tr>
            </tfoot> -->
            </nz-table>
            }
        </div>

    </div>