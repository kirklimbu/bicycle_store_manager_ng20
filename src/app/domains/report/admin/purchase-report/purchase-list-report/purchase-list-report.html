<!-- <nz-breadcrumb [nzAutoGenerate]="true"></nz-breadcrumb> -->
<div class="table-container">
    <div class="site-page-header-ghost-wrapper">
        <nz-page-header nzTitle="Purchase  Report" [nzGhost]="false">
            <nz-page-header-extra>
                <!-- <app-table-operations key="sakes-filter" [fields]="[
    { name: 'fromDate', label: 'From Date (B.S)', type: 'date', required: true },
    { name: 'toDate', label: 'To Date (B.S)', type: 'date', required: true },
    
  ]" (filterChange)="onFilterChange($event)" /> -->
                <lib-table-operations [showSelector1]="false" [selector1Options]="manualSelectorOptions"
                    [showAddButton]="false" [isLocalSearch]="false" [showSearch]="false" [showFromDate]="true"
                    [showToDate]="true" [defaultFromDate]="initialFilters().fromDate"
                    [defaultToDate]="initialFilters().toDate" [showSecondaryButton]="isCustomerMode()"
                    [showTertiaryButton]="isCustomerMode()" [secondaryButtonLabel]="'Sales'"
                    [tertiaryButtonLabel]="'Sales Return'" (search)="onSearch($event)"
                    (secondaryButtonClick)="onSales()" (tertiaryButtonClick)="onSalesReturn()" />
            </nz-page-header-extra>

        </nz-page-header>
    </div>

    <div class="enterprise-table-wrapper">
        @if(data$ | async; as data) {
        <nz-table #reportTable [nzData]="data" [nzBordered]="false" [nzFrontPagination]="true" nzSize="middle"
            [nzScroll]="{ x: '1600px' }">
            <thead>
                <tr>
                    <th nzLeft nzWidth="60px" nzAlign="center">#</th>
                    <th nzLeft nzWidth="120px">Date</th>
                    <th nzLeft nzWidth="130px">Supplier Bill</th>
                    <th nzWidth="180px">Supplier Name</th>
                    <th nzWidth="110px">PAN/VAT</th>

                    <th nzWidth="220px">Stock Name</th>
                    <th nzAlign="center" nzWidth="80px">Qty</th>
                    <th nzWidth="80px">Unit</th>
                    <th nzAlign="right" nzWidth="130px">Total Amt.</th>
                    <th nzAlign="right" nzWidth="110px">Tax Amt.</th>
                    <th nzAlign="right" nzWidth="120px" class="highlight-col">Net Amt</th>
                    <th nzWidth="100px" nzRight>Pay Type</th>
                </tr>
            </thead>
            <tbody>
                @for (item of reportTable.data; track item.purchaseDetailId; let i = $index) {
                <tr class="enterprise-row">
                    <td nzLeft nzAlign="center" class="num-mono text-muted">
                        {{ (reportTable.nzPageIndex - 1) * reportTable.nzPageSize + (i + 1) }}
                    </td>
                    <td nzLeft class="date-text">{{ item.saveDate | nepaliDateFormatter }}</td>
                    <td nzLeft class="bill-identifier">{{ item.supplierBillNo || 'N/A' }}</td>
                    <td class="supplier-text">{{ item.supplierName | titlecase }}</td>
                    <td class="num-mono small-text">{{ item.pan || '-' }}</td>

                    <td class="stock-text">{{ item.stockName }}</td>
                    <td nzAlign="center" class="num-mono">{{ item.qty | number }}</td>
                    <td class="text-muted">{{ item.unit }}</td>
                    <td nzAlign="right" class="num-mono">{{ item.totalAmt | number:'1.2-2' }}</td>
                    <td nzAlign="right" class="num-mono tax-color">{{ item.taxAmt | number:'1.2-2' }}</td>
                    <td nzAlign="right" class="num-mono net-amt-cell">{{ item.netAmt | number:'1.2-2' }}</td>
                    <td nzRight>
                        <span class="pay-badge" [class.credit]="item.payType === 'Credit'">
                            {{ item.payType }}
                        </span>
                    </td>
                </tr>
                }
            </tbody>
            <!-- <tfoot class="enterprise-footer">
        <tr>
          <td [nzLeft]="true" [colspan]="3" class="footer-label">Total Purchases</td>
          <td colspan="5" class="hide-mobile"></td> 
          <td nzAlign="right" class="footer-val">{{ calculateTotal(data, 'totalAmt') | number:'1.2-2' }}</td>
          <td nzAlign="right" class="footer-val">{{ calculateTotal(data, 'taxAmt') | number:'1.2-2' }}</td>
          <td nzAlign="right" class="footer-grand-total">
             <small>NPR</small> {{ calculateTotal(data, 'netAmt') | number:'1.2-2' }}
          </td>
          <td nzRight></td>
        </tr>
      </tfoot> -->
        </nz-table>
        }
    </div>
</div>