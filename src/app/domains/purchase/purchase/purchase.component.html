<!-- <nz-breadcrumb [nzAutoGenerate]="true"></nz-breadcrumb> -->
<div class="table-container">
  <div class="site-page-header-ghost-wrapper">
    <nz-page-header nzTitle="Purchase List" [nzGhost]="false">
      <nz-page-header-extra>
        <lib-table-operations [showSelector1]="false" [selector1Options]="manualSelectorOptions" [showAddButton]="false"
          [isLocalSearch]="false" [showSearch]="false" [showFromDate]="true" [showToDate]="true"
          [defaultFromDate]="initialFilters().fromDate" [defaultToDate]="initialFilters().toDate"
          [showSearchButton]="true" [showExportButton]="false" [showSecondaryButton]="true"
          [secondaryButtonLabel]="'Purchase'" [secondaryButtonIcon]="''" [tertiaryButtonIcon]="''"
          [showTertiaryButton]="true" [tertiaryButtonLabel]="'Purchase Return'" (search)="onSearch($event)"
          (secondaryButtonClick)="onPurchase()" (tertiaryButtonClick)="onPurchaseReturn()" />
      </nz-page-header-extra>
    </nz-page-header>

  </div>



  <!-- @if(data$|async;as data ){ -->

  <!-- <nz-table [nzFrontPagination]="false" #nzTable [nzBordered]="true" [nzData]="data" [nzScroll]="{ x: '900px' }">
    <thead>

      <tr>

        @for (column of listOfColumns; track column.name) {
        <th nzAlign="center" [nzFilters]="column.listOfFilter" [nzFilterFn]="column.filterFn">
          {{ column.name }}
        </th>
        }
      </tr>
    </thead>
    <tbody>
      @for (purchase of nzTable.data|search:filterCriteria; track
      purchase.purchaseId;) {

      <tr>
        <td nzWidth="1%" nzAlign="center">{{ $index + 1 }}.</td>
        <td nzWidth="20%" nzAlign="left">{{ purchase.stockName | titlecase }}</td>

        <td nzAlign="center">{{ purchase.saveDate | nepaliDateFormatter }}</td>
        <td nzAlign="center">{{ purchase.pricePerUnit }}</td>
        <td nzAlign="center">{{ purchase.qty }}</td>
        <td nzAlign="center">{{ purchase.taxableAmt }}</td>
        <td nzAlign="center">{{ purchase.taxAmt }}</td>
        <td nzAlign="center">{{ purchase.netAmt }}</td>

        <td nzAlign="center">
          <lib-table-action-buttons [showEditButton]="true" [showDeleteButton]="false" [showButton4]="false"
            [showViewMoreButton]="false" [button3Label]="'Lab'" [button4Label]="'Transaction'"
            [button3Icon]="'experiment'" [button4Icon]="'dollar'" (delete)="onDelete(purchase.purchaseId)"
            (edit)="onEdit(purchase)" (viewMore)="onViewMore(purchase.purchaseId)"
            (buttonAction4)="showTransaction(purchase.supplierId)" />
        </td>
      </tr>
      }
    </tbody>
  </nz-table> -->
  <!-- } -->

  <div class="enterprise-table-wrapper">
    @if (data(); as tableData) {
    <nz-table #nzTable [nzData]="tableData" [nzFrontPagination]="true" [nzPageSize]="10" nzSize="middle"
      [nzScroll]="{ x: '1200px' }">
      <thead>
        <tr>
          @for (column of listOfColumns; track column.name) {
          <th [nzLeft]="column.stickyLeft || false" [nzRight]="column.stickyRight || false" [nzWidth]="column.width"
            [nzAlign]="column.align || 'left'" [nzFilters]="column.listOfFilter || []"
            [nzFilterFn]="column.filterFn || null">
            {{ column.name }}
          </th>
          }
        </tr>
      </thead>
      <tbody>
        @for (purchase of nzTable.data | search: filterCriteria; track purchase.purchaseId; let i = $index) {
        <tr class="enterprise-row">
          <td nzLeft nzAlign="center" class="num-mono text-muted">
            {{ (nzTable.nzPageIndex - 1) * nzTable.nzPageSize + (i + 1) }}
          </td>

          <td nzLeft class="sticky-col-main">{{ purchase.stockName | titlecase }}</td>

          <td nzAlign="center" class="date-cell">{{ purchase.saveDate | nepaliDateFormatter }}</td>
          <td nzAlign="right" class="num-mono">{{ purchase.pricePerUnit | number:'1.2-2' }}</td>
          <td nzAlign="center" class="num-mono qty-text">{{ purchase.qty | number }}</td>
          <td nzAlign="right" class="num-mono">{{ purchase.taxableAmt | number:'1.2-2' }}</td>
          <td nzAlign="right" class="num-mono tax-text">{{ purchase.taxAmt | number:'1.2-2' }}</td>
          <td nzAlign="right" class="num-mono net-amt-cell">{{ purchase.netAmt | number:'1.2-2' }}</td>

          <td nzRight nzAlign="center">
            <div class="action-bundle">
              <lib-table-action-buttons [showEditButton]="true" [showDeleteButton]="false" [showButton4]="false"
                [showViewMoreButton]="false" (edit)="onEdit(purchase)" (delete)="onDelete(purchase.purchaseId)" />
            </div>
          </td>
        </tr>
        }
      </tbody>
    </nz-table>
    }
  </div>
</div>